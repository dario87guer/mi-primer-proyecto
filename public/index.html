<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SISTEMA CONTROL - DAR√çO MORALES</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --color-principal: #6366f1;
            --color-principal-dark: #3730a3;
            --color-sec: #10b981;
            --color-nav: #18193f;
            --color-bg: #f8fafc;
            --color-bg-card: #fff;
            --color-border: #d1d5db;
            --color-fondo-table: #f3f4f6;
            --color-shadow: 0 8px 24px rgba(31,41,55,.08);
            --nav-width-min: 55px;
            --nav-width-max: 220px;
            --sombra-menu: 0 6px 26px 0 rgba(49,47,114,0.06);
            --alto-menu: 58px;
        }
        html, body {
            font-family: 'Inter', sans-serif;
            background: var(--color-bg);
            color: #334155; margin: 0; height: 100%; overflow: hidden;
        }
        body { display: flex; height: 100vh; }
        .sidebar {
            position: fixed; top: 0; left: 0; z-index: 1010;
            width: var(--nav-width-min); height: 100vh;
            background: linear-gradient(180deg,var(--color-principal-dark) 0%, #282068 100%);
            box-shadow: var(--sombra-menu);
            display: flex; flex-direction: column; transition: width 0.17s cubic-bezier(.42,.1,.62,1.12);
        }
        .sidebar.expanded { width: var(--nav-width-max); }
        .sidebar-header {
            height: var(--alto-menu); display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 900; font-size: 17px; border-bottom: 2px solid rgba(200,200,255,0.11);
        }
        .sidebar-nav { flex: 1; display: flex; flex-direction: column; gap: 7px; padding: 10px 5px; }
        .nav-btn {
            width: 100%; background: transparent; border: none; color: #e0e7ef; font-weight: 600;
            cursor: pointer; border-radius: 8px; display: flex; align-items: center;
            padding: 12px 0; font-size: 16px; transition: background .17s;
        }
        .nav-btn.active, .nav-btn:hover { background: linear-gradient(90deg, var(--color-principal) 0%, #343391 85%); color: #fff; }
        .nav-icon { width: 28px; min-width: 28px; display: flex; justify-content: center; font-size: 20px; margin: 0 5px; opacity: 0.94; }
        .nav-label { display: none; margin-left: 19px; }
        .sidebar.expanded .nav-label { display: inline; }
        .expand-toggle-btn {
            position: absolute; top: 19px; right: -13px; z-index: 1020; width: 27px; height: 27px;
            background: var(--color-principal); border-radius: 50%; display: flex; align-items: center;
            justify-content: center; border: 2px solid #fff; cursor: pointer; color: #fff;
        }
        .main-content {
            flex: 1; margin-left: var(--nav-width-min); transition: margin-left 0.17s;
            overflow-y: auto; box-sizing: border-box; width: 100%;
        }
        .sidebar.expanded ~ .main-content { margin-left: var(--nav-width-max); }
        .modal, .site-dialog {
            display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 5000; background: rgba(23,29,54, .58); align-items: center; justify-content: center;
        }
        .modal-content, .dialog-content {
            background: #fff; border-radius: 16px; padding: 38px 28px;
            max-width: 410px; width: 95vw; box-shadow: 0 10px 42px rgba(0,0,0,0.2);
            animation: fadeInDialog .18s ease-out;
        }
        @keyframes fadeInDialog { from { transform: translateY(20px); opacity: 0;} to { transform: none; opacity: 1;} }
        
        /* Estilos base para Cards (Usados en selectores) */
        .card-menu {
            background: #fff; border-radius: 15px; padding: 25px; text-align: center;
            border: 1px solid var(--color-border); cursor: pointer; transition: 0.2s;
            box-shadow: var(--color-shadow);
        }
        .card-menu:hover { transform: translateY(-5px); border-color: var(--color-principal); }
        .card-menu h3 { margin: 15px 0 5px 0; color: var(--color-principal-dark); font-weight: 900; }
        .card-menu span { font-size: 40px; }
    </style>
    </head>
<body>
    <div class="sidebar" id="sidebarNav">
        <div class="sidebar-header">üìä <span class="logo-txt" style="margin-left:12px;">SISTEMA</span></div>
        <button class="expand-toggle-btn" id="expandBtn" onclick="toggleSidebar()">‚ñ∂</button>
        <div class="sidebar-nav">
            <button class="nav-btn active" onclick="loadSection('importar')"><span class="nav-icon">üì•</span><span class="nav-label">Importar</span></button>
            <button class="nav-btn" onclick="loadSection('red')"><span class="nav-icon">üü°</span><span class="nav-label">Red</span></button>
            <button class="nav-btn" onclick="loadSection('diario')"><span class="nav-icon">üìÖ</span><span class="nav-label">Diario</span></button>
            <button class="nav-btn" onclick="loadSection('mensual')"><span class="nav-icon">üìà</span><span class="nav-label">Mensual</span></button>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div id="view-container">
            </div>
    </div>

    <div id="siteDialog" class="site-dialog"><div class="dialog-content" id="dialog-body"></div></div>

    <script>
        // SECCI√ìN ESTABLE - INICIO
        let sidebarExpanded = false;
        function toggleSidebar() {
            sidebarExpanded = !sidebarExpanded;
            document.getElementById('sidebarNav').classList.toggle('expanded', sidebarExpanded);
            document.getElementById('expandBtn').innerText = sidebarExpanded ? '‚óÄ' : '‚ñ∂';
            document.getElementById('mainContent').style.marginLeft = sidebarExpanded ? "var(--nav-width-max)" : "var(--nav-width-min)";
        }

        async function loadSection(name) {
            const container = document.getElementById('view-container');
            container.innerHTML = '<div style="padding:50px; text-align:center;"><h2>Cargando...</h2></div>';
            try {
                const response = await fetch(`${name}.html`);
                const html = await response.text();
                container.innerHTML = html;
                
                // Ejecutar scripts din√°micos
                const scripts = container.querySelectorAll('script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement("script");
                    if (oldScript.src) newScript.src = oldScript.src;
                    else newScript.textContent = oldScript.textContent;
                    document.body.appendChild(newScript).parentNode.removeChild(newScript);
                });
            } catch (err) {
                container.innerHTML = '<div style="padding:50px; text-align:center;"><h2>Error al cargar la secci√≥n.</h2></div>';
            }
            
            // Marcar bot√≥n activo
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.getAttribute('onclick').includes(`'${name}'`)) btn.classList.add('active');
                else btn.classList.remove('active');
            });
        }

        window.onload = () => loadSection('importar');
        // SECCI√ìN ESTABLE - FIN
    </script>
</body>
</html>