<div style="padding: 30px;">
    <h2 style="font-weight: 900; color: var(--color-principal-dark); margin-bottom: 25px; letter-spacing: -0.02em;">
        Seleccione Empresa para Importar
    </h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
        
        <div class="card-menu" onclick="loadSection('importar_pf')">
            <span>üîµ</span>
            <h3>PAGO F√ÅCIL</h3>
            <p style="font-size: 13px; color: #64748b;">Importaci√≥n de archivos .TXT</p>
            <div id="date-pf" style="margin-top:15px; font-size:11px; font-weight:800; color:var(--color-principal);">√öltima carga: Consultando...</div>
        </div>

        <div class="card-menu" onclick="loadSection('importar_seac')">
            <span>üü¢</span>
            <h3>SEAC</h3>
            <p style="font-size: 13px; color: #64748b;">Excel de Ventas y D√©bitos</p>
            <div id="date-seac" style="margin-top:15px; font-size:11px; font-weight:800; color:var(--color-principal);">√öltima carga: Consultando...</div>
        </div>

        <div class="card-menu" onclick="loadSection('importar_ce')">
            <span>üü†</span>
            <h3>COBRO EXPRESS</h3>
            <p style="font-size: 13px; color: #64748b; margin-bottom: 12px;">Detalle y Diario de operaciones</p>
            <div style="display: flex; flex-direction: column; gap: 5px; align-items: center;">
                <div id="date-ce-diario" style="font-size:10px; font-weight:800; color:#334155; background: #f1f5f9; padding: 5px 12px; border-radius: 6px; width: 90%; text-align: center;">
                    √öltima subida archivo diario: Consultando...
                </div>
                <div id="date-ce-detalle" style="font-size:10px; font-weight:800; color:#f59e0b; background: #fffbeb; padding: 5px 12px; border-radius: 6px; width: 90%; text-align: center;">
                    √öltima subida archivo detallado: Consultando...
                </div>
            </div>
        </div>
        </div>
</div>

<script>
    // SECCION PROHIBIDO TOCAR - INICIO
    async function actualizarFechasCards() {
        try {
            const res = await fetch('/api/ultimas-fechas');
            const data = await res.json();
            
            const map = { "PAGO F√ÅCIL": "date-pf", "SEAC": "date-seac" };
            
            data.forEach(d => {
                if (d.empresa === "COBRO EXPRESS") {
                    const fDiario = d.ultima_fecha_diario ? formatearFecha(d.ultima_fecha_diario) : "Sin datos";
                    const fDetalle = d.ultima_fecha_detalle ? formatearFecha(d.ultima_fecha_detalle) : "Sin datos";
                    
                    document.getElementById('date-ce-diario').innerText = `√öltima subida archivo diario: ${fDiario}`;
                    document.getElementById('date-ce-detalle').innerText = `√öltima subida archivo detallado: ${fDetalle}`;
                } else if (map[d.empresa]) {
                    const el = document.getElementById(map[d.empresa]);
                    el.innerText = `√öltima carga: ${formatearFecha(d.ultima_fecha)}`;
                }
            });
        } catch(e) { console.error("Error al cargar fechas", e); }
    }

    function formatearFecha(fechaStr) {
        if(!fechaStr) return "---";
        const f = new Date(fechaStr);
        // Ajuste de zona horaria para evitar desfase de un d√≠a
        const d = f.getUTCDate().toString().padStart(2,'0');
        const m = (f.getUTCMonth()+1).toString().padStart(2,'0');
        const y = f.getUTCFullYear();
        return `${d}/${m}/${y}`;
    }

    actualizarFechasCards();
    // // SECCION PROHIBIDO TOCAR - FIN.
</script>